%% amsmath_lxir.sty
%% part of lxir - a tool to convert latex documents to xml.
%% Copyright 2007 EDP-Sciences
%
% This work may be distributed and/or modified under the
% conditions of the LaTeX Project Public License, either version 1.3
% of this license or (at your option) any later version.
% The latest version of this license is in
%   http://www.latex-project.org/lppl.txt
% and version 1.3 or later is part of all distributions of LaTeX
% version 2005/12/01 or later.
%
% This work has the LPPL maintenance status `maintained'.
% 
% The Current Maintainer of this work is EDP-Sciences.
%
% This work consists of the files amsmath_lxir.sty.
% amsmath redefinie cette macro
\ifverbatimmath

\def\lxiramsenv#1{\xBegin{#1}\refstepcounter{equation}\begingroup\@formule \frenchspacing\@vobeyspaces
              \formule@start}
\def\endlxiramsenv#1{\endgroup\xEmptyA{eqnnum}{value=\theequation}\xEnd{#1}}
\def\lxiramsenvstar#1{\xBegin{#1}\begingroup\@formule \frenchspacing\@vobeyspaces
              \formule@start}
\def\endlxiramsenvstar#1{\endgroup\xEnd{#1}}

\renewenvironment{equation}{\lxiramsenv{equation}}{\endlxiramsenv{equation}}
\renewenvironment{equation*}{\lxiramsenvstar{equation-star}}{\endlxiramsenvstar{equation-star}}
\renewenvironment{multline}{\lxiramsenv{multline}}{\endlxiramsenv{multline}}
\renewenvironment{multline*}{\lxiramsenvstar{multline-star}}{\endlxiramsenvstar{multline-star}}
\renewenvironment{gather}{\lxiramsenv{gather}}{\endlxiramsenv{gather}}
\renewenvironment{gather*}{\lxiramsenvstar{gather-star}}{\endlxiramsenvstar{gather-star}}
\renewenvironment{align}{\lxiramsenv{align}}{\endlxiramsenv{align}}
\renewenvironment{align*}{\lxiramsenvstar{align-star}}{\endlxiramsenvstar{align-star}}
\renewenvironment{flalign}{\lxiramsenv{flalign}}{\endlxiramsenv{flalign}}
\renewenvironment{flalign*}{\lxiramsenvstar{flalign-star}}{\endlxiramsenvstar{flalign-star}}
\renewenvironment{split}{\lxiramsenv{split}}{\endlxiramsenv{split}}
\renewenvironment{gathered}{\lxiramsenv{gathered}}{\endlxiramsenv{gathered}}
\renewenvironment{aligned}{\lxiramsenv{aligned}}{\endlxiramsenv{aligned}}
\else
\def\@eqnnum{\xEmptyA{equationumber}{value=\theequation}}
\renewenvironment{equation}{%
  \incr@eqnum
  \mathdisplay@push
  \st@rredfalse \global\@eqnswtrue
  \xBegin{equation}
  \mathdisplay{equation}%
}{%
  \endmathdisplay{equation}%
  \xEmptyA{eqnnum}{value=\theequation}\xEnd{equation}
  \mathdisplay@pop
  \ignorespacesafterend
}
\let\endmathdisplay@a=\relax
\fi